/*
 * bird configuration for mp-bgp mpls vpn 4+6
 */ 
define myip = 172.27.0.6;
define mrtdumpinterval = 10;

debug commands 2;
debug protocols all;

router id 10.0.0.1;
define myas = 65000;

mrtdump protocols all;

### templates
template bgp bgp_peer {
    debug all;
    mrtdump all;
    local as myas;
    ipv4 { import all; export none; };
    ipv6 { import all; export none; };
    ipv4 mpls { import all; export none; };
    ipv6 mpls { import all; export none; };
    multihop;
    rs client;
    enable as4 on;
    enable extended messages off;
    capabilities on;
    interpret communities off;  
    deterministic med on;
}


ipv4 table testv4;
ipv6 table testv6;
ipv4 table testv4mpls;
ipv6 table testv6mpls;
vpn4 table testvpn4;
vpn6 table testvpn6;

protocol bgp gobgp from bgp_peer {
    neighbor myip port 17000 as 65002;
    local myip as 65000;

    ipv4 { table testv4; };
    ipv6 { table testv6; };
    ipv4 mpls { table testv4mpls; };
    ipv6 mpls { table testv6mpls; };
    vpn4 mpls { 
        table testvpn4; 
        import filter { accept; };
        export none;
        extended next hop; 
    };
    vpn6 mpls {
        table testvpn6;
        import filter { accept; };
        export none;
        extended next hop; };
}

protocol mrt {
    table testv4;
    filename "testv4.mrt";
    period mrtdumpinterval;
}

protocol mrt {
    table testv6;
    filename "testv6.mrt";
    period mrtdumpinterval;
}

protocol mrt {
    table testv4mpls;
    filename "testv4mpls.mrt";
    period mrtdumpinterval;
}

protocol mrt {
    table testv6mpls;
    filename "testv6mpls.mrt";
    period mrtdumpinterval;
}

protocol mrt {
    table testvpn4;
    filename "testvpn4.mrt";
    period mrtdumpinterval;
}

protocol mrt {
    table testvpn6;
    filename "testvpn6.mrt";
    period mrtdumpinterval;
}
